---
title: "R 語言上手篇"
author: "Wush Wu"
date: "2015年9月25日"
output: 
  slidy_presentation: 
    keep_md: yes
---

# Why Use R?
```{r setup, include=FALSE, cache=FALSE}
library(knitr)
library(magrittr)
library(xtable)
library(data.table)
library(dplyr)
library(broom)
library(ggplot2)
library(quantmod)
library(pander)
library(wordcloud)
library(RColorBrewer)
opts_chunk$set(echo = FALSE, cache=TRUE, comment="", cache.path = ".cache-EDA/")
fig <- function(path, size = 100) {
  sprintf("<img src='img/%s' style='max-width: %d%%;max-height: %d%%'></img>", 
          path, size, size)
}
fig2 <- function(path, size = 100) {
  sprintf("<img src='img/%s' style='width: %d%%'></img>", 
          path, size)
}
sys_name <- Sys.info()["sysname"] %>% tolower
sys_encode <- c("utf8", "utf8", "big5")[pmatch(sys_name, c("linux", "darwin", "windows"))]
sessionInfo() %>% capture.output %>% cat(file = "sessionInfo.log", sep = "\n")
```

# R 來自世界上最專業的統計學家 {.smaller}

<center>`r fig('statician_10521919-655x280.jpg')`</center>

取自 <http://myfootpath.com/careers/engineering-careers/statistician-careers/>


# R 可以輸出高品質的視覺化 {.smaller}

`r fig("flights_sml.jpg", 100)`

取自 <http://www.r-bloggers.com/mapping-the-worlds-biggest-airlines/>


# R 有驚人彈性和潛力 {.smaller}

<center>`r fig("fig_10_cran1.png", 50)`</center>

取自 <http://r4stats.com/2013/03/19/r-2012-growth-exceeds-sas-all-time-total/>


# R 很容易和其他工具整合 {.smaller}

<center>
```{r r-integration, warning=FALSE}
tools <- strsplit("Rcpp,rJava,rpy2,RHadoop,RMySQL,RPostgreSQL,RJDBC,RODBC,ROpenOffice,rredis,rmongodb,RSelenium", ",")[[1]]
freq <- rep(1, length(tools))
pal <- brewer.pal(length(tools),"BuGn")
wordcloud(tools, freq, random.color = TRUE, colors = pal)
```
</center>

# R 很容易擴充和客製化 {.smaller}

<center>`r fig("t134_3ca_lg.jpg", 100)`</center>
取自 <http://img.diynetwork.com/DIY/2003/09/18/t134_3ca_med.jpg>

# 和其他工具相比，R 的特色

- R 有非常先進的數據視覺化系統
- R 有很多的進階數據分析工具

# 範例 - 探索數據的分佈

- 統計很多理論都需要常態分佈
- 但是一組數據真的是常態分佈嗎？

```{r ks.test1}
x <- c(rnorm(50), rnorm(50, 4))
plot(density(x))
```

# 範例 - 探索數據的分佈

- R 可以很快的告訴你

```{r ks.test2, echo = TRUE, dependson="ks.test"}
shapiro.test(x)
```

# 範例 - 探索數據的分佈

- R 也可以比較兩個數據是不是來自相同的分佈

```{r ks.test3, echo = TRUE}
x1 <- rnorm(50)
x2 <- rt(50, df = 2)
plot(density(x1), xlim = range(c(x1, x2)), main = "Sample PDF")
lines(density(x2), col = 2)
legend("topright", c("x1", "x2"), lty = 1, col = 1:2)
```

# 範例 - 探索數據的分佈

- 檢定？沒問題

```{r ks.test4, echo = TRUE, dependson="ks.test3"}
ks.test(x1, x2)
```

# 範例 - 數據間的比較

- 我們使用有兩套方法做推薦，要比較推薦的成果
- 方法A：在10000點擊有10個購買
- 方法B：在5000 點擊有3 個購買
- 我怎麼知道這兩種方法的轉換率（購買/點擊）是不是明顯不同？

# 範例 - 數據間的比較

- 我不懂檢定，但是簡單的跑模擬就可以告訴我們答案。

```{r conversion, echo = TRUE}
# 假設方法A 真正的轉換率和就是 3 / 5000
p <- 3/5000
# 我們可以模擬1000次在10000個點擊下，方法A 的轉換數
plot(density(x <- rbinom(1000, 10000, p)))
```

# 範例 - 數據間的比較

- 利用模擬結果做比較

```{r conversion2, echo = TRUE, dependson="conversion"}
# 估計超過我們觀測值的機率
mean(x > 10)
```

# 範例 - 數據間的比較

- 我大致上懂檢定，但是我不想自己寫程式算信賴區間。

```{r ci, echo = TRUE}
library(binom)
binom.confint(c(10, 3), c(10000, 5000), methods = "exact")
```

# 範例 - 數據間的比較

- 太棒了，但是我想用某篇paper的方法。你可以找找看有沒有你要的方法：

<center>`r fig("binom-methods.png", 100)`</center>

# 範例 - 相關性

- R 擁有許多你想像不到的方式來探索數據
    - 他們都來自於世界各地的貢獻者

```{r chart.correlation, results = 'hide', warning = FALSE}
suppressPackageStartupMessages(library(PerformanceAnalytics))
chart.Correlation(iris[-5], bg=iris$Species, pch=21)
```

# 範例 - 相關性

- 許多機器學習的方法，會假設數據彼此之間是獨立的
    - R 可以迅速幫你檢驗數據是否是獨立的

```{r chart.ACFplus}
data(edhec)
chart.ACFplus(edhec[,1,drop=FALSE])
```

# 範例 - 相關性

```{r heatmap, results = "hide"}
round(Ca <- cor(attitude), 2)
symnum(Ca) # simple graphic
heatmap(Ca,               symm = TRUE, margins = c(6,6))
```

# 範例 - 經濟學人風格的圖示

```{r ggthemes}
library(ggthemes)
dsamp <- diamonds[sample(nrow(diamonds), 1000), ]
q <- (qplot(carat, price, data=dsamp, colour=clarity)
      + ggtitle("Diamonds Are Forever"))

## Standard
q + theme_economist() + scale_colour_economist()
```

# 範例 - 視覺化

```{r}
library(ggplot2)
library(maps)
library(rgeos)
library(maptools)
```

# 一些R 的閃電秀：你可以用R 做什麼

- [OpenCPU](https://docs.google.com/presentation/d/1VlmgZ5pTjmOf-qSa2iLWpeas12NxTzx3nIQLJiLn8YQ/edit#slide=id.gb89eb8dd3_0_0)
- [Time Series Clustering](https://docs.google.com/presentation/d/180wT8FunXbGFGqj8Kv3p7mtHJ7g-BJt9XipRIlmNMEE/edit?usp=sharing)
- [quantstrat](https://docs.google.com/presentation/d/16xjdjXf6hSdpV0hZDjNth9LdyVMVKkXs5WZHg6IFCTU/edit?usp=sharing)
- [Text Mining](http://whizzalan.github.io/RTextMining/lightingTalk)
- [Baseball](http://suensummit.github.io/lightning-DSC2015-R/#1)
- [Crawler](http://chihchengliang.github.io/DSC2015_Crawler/)
- [FeatureHashing](https://github.com/wush978/FeatureHashing/blob/master/vignettes/SentimentAnalysis.Rmd)
- [Rcpp]()

# R 的Community 非常活躍

- 任何和資料相關的服務，有很大的機會可以和R 串接
    - [Google Sheets R API](https://github.com/jennybc/googlesheets)
    - [Google Map](https://cran.r-project.org/package=RgoogleMaps)
    - [Excel](https://cran.r-project.org/web/packages/readxl/index.html)
    - [Minitab, S, SAS, SPSS, Stata, Systat and Weka...](https://cran.r-project.org/web/packages/foreign/index.html)
    - [DBI](https://cran.r-project.org/web/packages/DBI/index.html)

# Community 甚至創造了一個學R 的套件：swirl

